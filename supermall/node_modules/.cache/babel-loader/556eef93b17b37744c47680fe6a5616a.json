{"remainingRequest":"E:\\softdev\\conderwhy-vue\\Day 10\\课堂代码\\supermall\\node_modules\\babel-loader\\lib\\index.js!E:\\softdev\\conderwhy-vue\\Day 10\\课堂代码\\supermall\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\softdev\\conderwhy-vue\\Day 10\\课堂代码\\supermall\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\softdev\\conderwhy-vue\\Day 10\\课堂代码\\supermall\\src\\views\\detail\\Detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\softdev\\conderwhy-vue\\Day 10\\课堂代码\\supermall\\src\\views\\detail\\Detail.vue","mtime":1627722940965},{"path":"E:\\softdev\\conderwhy-vue\\Day 10\\课堂代码\\supermall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\softdev\\conderwhy-vue\\Day 10\\课堂代码\\supermall\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\softdev\\conderwhy-vue\\Day 10\\课堂代码\\supermall\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\softdev\\conderwhy-vue\\Day 10\\课堂代码\\supermall\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport DetailNavBar from \"./childcomps/DetailnavBar.vue\";\nimport { getDetail, Goods, Shop, GoodsParam, getRecommend } from \"../../network/detail.js\";\nimport DetailSwiper from \"../detail/childcomps/DeteilSwiper.vue\";\nimport DetailBaseInfo from \"./childcomps/DetailBaseInfo.vue\";\nimport DetailShopInfo from \"./childcomps/DetailShopInfo.vue\";\nimport Scroll from \"../../components/common/scroll/Scroll.vue\";\nimport DetailGoodsInfo from '../detail/childcomps/DetailGoodsInfo.vue';\nimport DetailParamInfo from '../detail/childcomps/DetailParamInfo.vue';\nimport DetailCommentInfo from '../detail/childcomps/DetailCommentInfo.vue';\nimport GoodsList from '../../components/content/goods/GoodsList.vue';\nimport { debounce } from \"../../common/utils/utils\";\nimport DetailBottomBar from '../detail/childcomps/DetailBottomBar.vue';\nimport backTop from '../../components/content/backTop/BackTop.vue';\nexport default {\n  name: \"Detail\",\n  components: {\n    DetailNavBar: DetailNavBar,\n    DetailSwiper: DetailSwiper,\n    DetailBaseInfo: DetailBaseInfo,\n    DetailShopInfo: DetailShopInfo,\n    Scroll: Scroll,\n    DetailGoodsInfo: DetailGoodsInfo,\n    DetailParamInfo: DetailParamInfo,\n    DetailCommentInfo: DetailCommentInfo,\n    GoodsList: GoodsList,\n    DetailBottomBar: DetailBottomBar,\n    backTop: backTop\n  },\n  data: function data() {\n    return {\n      iid: null,\n      topImages: [],\n      goods: {},\n      shop: {},\n      detailInfo: {},\n      paramInfo: {},\n      commentInfo: {},\n      recommends: [],\n      themeTopYs: [],\n      currentIndex: 0,\n      getThemeTopY: null,\n      isShowBackTop: false\n    };\n  },\n  created: function created() {\n    var _this = this;\n\n    // 1.保存传入的iid\n    this.iid = this.$route.params.iid; // 2.根据iid请求详情数据\n\n    getDetail(this.iid).then(function (res) {\n      // 1.获取顶部的图片轮播数据\n      //console.log(res);\n      var data = res.result;\n      _this.topImages = data.itemInfo.topImages; // 2.获取商品信息\n\n      _this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services); // 3.创建店铺信息的对象\n\n      _this.shop = new Shop(data.shopInfo); // 4.保存商品的详情数据\n\n      _this.detailInfo = data.detailInfo; // 5.获取参数的信息\n\n      _this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule); //6.保存评论信息\n\n      if (data.rate.cRate !== 0) {\n        _this.commentInfo = data.rate.list[0];\n      } //获取评论信息\n\n\n      getRecommend().then(function (res) {\n        _this.recommends = res.data.list;\n      }); //给getThemTopY赋值\n\n      _this.getThemeTopY = debounce(function () {\n        _this.themeTopYs = [];\n\n        _this.themeTopYs.push(0);\n\n        _this.themeTopYs.push(_this.$refs.params.$el.offsetTop);\n\n        _this.themeTopYs.push(_this.$refs.comment.$el.offsetTop);\n\n        _this.themeTopYs.push(_this.$refs.recommend.$el.offsetTop);\n\n        _this.themeTopYs.push(Number.MAX_VALUE); //console.log(this.themeTopYs);\n\n      }, 100);\n    });\n  },\n  methods: {\n    imageLoad: function imageLoad() {\n      this.$refs.scroll.refresh();\n      this.getThemeTopY();\n      /*this.themeTopYs = []\r\n          this.themeTopYs.push(0);\r\n          this.themeTopYs.push(this.$refs.params.$el.offsetTop)\r\n          this.themeTopYs.push(this.$refs.comment.$el.offsetTop)\r\n          this.themeTopYs.push(this.$refs.recommend.$el.offsetTop)\r\n          this.themeTopYs.push(Number.MAX_VALUE)\r\n            console.log(this.themeTopYs)*/\n    },\n    backClick: function backClick() {\n      this.$refs.scroll.scrollTo(0, 0);\n    },\n    titleClick: function titleClick(index) {\n      this.$refs.scroll.scrollTo(0, -this.themeTopYs[index], 300);\n    },\n    contentScroll: function contentScroll(position) {\n      //监听BackTop到什么位置显示\n      this.isShowBackTop = -position.y > 1000;\n      var positionY = -position.y;\n      var length = this.themeTopYs.length;\n\n      for (var i = 0; i < length; i++) {\n        if (this.currentIndex != i && (i < length - 1 && positionY >= this.themeTopYs[i] && positionY < this.themeTopYs[i + 1] || i === length - 1 && positionY >= this.themeTopYs[i])) {\n          //console.log(i);\n          this.currentIndex = i;\n          this.$refs.nav.currentIndex = this.currentIndex;\n        }\n      }\n    },\n    addToCart: function addToCart() {\n      //获取商品的信息\n      var product = {};\n      product.image = this.topImages[0];\n      product.title = this.goods.title;\n      product.desc = this.goods.desc;\n      product.price = this.goods.realPrice;\n      product.iid = this.iid; //将商品添加到购物车\n      //this.$store.commit('addCart', product)\n    }\n  }\n};",{"version":3,"sources":["Detail.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div id=\"detail\">\r\n    <detail-nav-bar class=\"detail-nav\" @titleClick=\"titleClick\" ref=\"nav\"/>\r\n    <scroll class=\"content\" ref=\"scroll\" :probe-type=\"3\" @scroll=\"contentScroll\">\r\n      <detail-swiper :top-images=\"topImages\" />\r\n      <detail-base-info :goods=\"goods\" />\r\n      <detail-shop-info :shop=\"shop\" />\r\n      <detail-goods-info :detail-info=\"detailInfo\" @imageLoad=\"imageLoad\" />\r\n      <detail-param-info ref=\"params\" :param-info=\"paramInfo\" />\r\n      <detail-comment-info ref=\"comment\" :comment-info=\"commentInfo\" />\r\n      <goods-list ref=\"recommend\" :goods=\"recommends\"/>\r\n    </scroll>\r\n    <detail-bottom-bar @addCart=\"addToCart\"/>\r\n    <back-top @click.native=\"backClick\" v-show=\"isShowBackTop\"/>\r\n    \r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport DetailNavBar from \"./childcomps/DetailnavBar.vue\";\r\nimport { getDetail, Goods, Shop ,GoodsParam,getRecommend} from \"../../network/detail.js\";\r\nimport DetailSwiper from \"../detail/childcomps/DeteilSwiper.vue\";\r\nimport DetailBaseInfo from \"./childcomps/DetailBaseInfo.vue\";\r\nimport DetailShopInfo from \"./childcomps/DetailShopInfo.vue\";\r\nimport Scroll from \"../../components/common/scroll/Scroll.vue\";\r\nimport DetailGoodsInfo from '../detail/childcomps/DetailGoodsInfo.vue'\r\nimport DetailParamInfo from '../detail/childcomps/DetailParamInfo.vue'\r\nimport DetailCommentInfo from '../detail/childcomps/DetailCommentInfo.vue'\r\nimport GoodsList from '../../components/content/goods/GoodsList.vue'\r\nimport {debounce} from \"../../common/utils/utils\"\r\nimport DetailBottomBar from '../detail/childcomps/DetailBottomBar.vue'\r\nimport backTop from '../../components/content/backTop/BackTop.vue'\r\n\r\nexport default {\r\n  name: \"Detail\",\r\n  components: {\r\n    DetailNavBar,\r\n    DetailSwiper,\r\n    DetailBaseInfo,\r\n    DetailShopInfo,\r\n    Scroll,\r\n    DetailGoodsInfo,\r\n    DetailParamInfo,\r\n    DetailCommentInfo,\r\n    GoodsList,\r\n    DetailBottomBar,\r\n    backTop\r\n\r\n  },\r\n    data() {\r\n      return {\r\n        iid: null,\r\n        topImages: [],\r\n        goods: {},\r\n        shop: {},\r\n        detailInfo: {},\r\n        paramInfo: {},\r\n        commentInfo:{},\r\n        recommends:[],\r\n        themeTopYs:[],\r\n        currentIndex: 0,\r\n        getThemeTopY:null,\r\n        isShowBackTop: false,\r\n      }\r\n    },\r\n    created() {\r\n      // 1.保存传入的iid\r\n      this.iid = this.$route.params.iid\r\n\r\n      // 2.根据iid请求详情数据\r\n      getDetail(this.iid).then(res => {\r\n        // 1.获取顶部的图片轮播数据\r\n        //console.log(res);\r\n        const data = res.result;\r\n        this.topImages = data.itemInfo.topImages\r\n\r\n        // 2.获取商品信息\r\n        this.goods = new Goods(data.itemInfo, data.columns, data.shopInfo.services)\r\n\r\n        // 3.创建店铺信息的对象\r\n        this.shop = new Shop(data.shopInfo)\r\n\r\n        // 4.保存商品的详情数据\r\n        this.detailInfo = data.detailInfo;\r\n\r\n        // 5.获取参数的信息\r\n        this.paramInfo = new GoodsParam(data.itemParams.info, data.itemParams.rule)\r\n\r\n        //6.保存评论信息\r\n        if(data.rate.cRate !== 0){\r\n          this.commentInfo = data.rate.list[0]\r\n        }\r\n        //获取评论信息\r\n        getRecommend().then(res =>{\r\n          this.recommends = res.data.list\r\n        })\r\n         //给getThemTopY赋值\r\n     this.getThemeTopY = debounce(() => {\r\n      this.themeTopYs = []\r\n      this.themeTopYs.push(0);\r\n      this.themeTopYs.push(this.$refs.params.$el.offsetTop);\r\n      this.themeTopYs.push(this.$refs.comment.$el.offsetTop);\r\n      this.themeTopYs.push(this.$refs.recommend.$el.offsetTop);\r\n      this.themeTopYs.push(Number.MAX_VALUE);\r\n          //console.log(this.themeTopYs);\r\n    },100)\r\n\r\n          \r\n      \r\n      \r\n      })\r\n      \r\n      \r\n    },\r\n  methods:{\r\n    imageLoad(){\r\n      this.$refs.scroll.refresh()\r\n      this.getThemeTopY()\r\n\r\n      /*this.themeTopYs = []\r\n          this.themeTopYs.push(0);\r\n          this.themeTopYs.push(this.$refs.params.$el.offsetTop)\r\n          this.themeTopYs.push(this.$refs.comment.$el.offsetTop)\r\n          this.themeTopYs.push(this.$refs.recommend.$el.offsetTop)\r\n          this.themeTopYs.push(Number.MAX_VALUE)\r\n\r\n          console.log(this.themeTopYs)*/\r\n    },\r\n    backClick() {\r\n      this.$refs.scroll.scrollTo(0, 0)\r\n    },\r\n    titleClick(index){\r\n      this.$refs.scroll.scrollTo(0, -this.themeTopYs[index], 300)\r\n    },\r\n    contentScroll(position){\r\n      //监听BackTop到什么位置显示\r\n      this.isShowBackTop = (-position.y) > 1000\r\n      const positionY = -position.y;\r\n      let length = this.themeTopYs.length;\r\n      for(let i = 0; i < length; i++) {\r\n        if(this.currentIndex != i && (i < length - 1 && positionY >= this.themeTopYs[i] && positionY < this.themeTopYs[i + 1] || (i === length -1 && positionY >= this.themeTopYs[i]))) {\r\n          //console.log(i);\r\n          this.currentIndex = i;\r\n          this.$refs.nav.currentIndex = this.currentIndex\r\n        }\r\n      }\r\n    },\r\n    addToCart(){\r\n      //获取商品的信息\r\n      const product = {}\r\n      product.image = this.topImages[0]\r\n      product.title = this.goods.title\r\n      product.desc = this.goods.desc\r\n      product.price = this.goods.realPrice\r\n      product.iid = this.iid\r\n      \r\n      //将商品添加到购物车\r\n      //this.$store.commit('addCart', product)\r\n      \r\n    }\r\n  }\r\n  }  \r\n</script>\r\n\r\n<style scoped>\r\n#detail {\r\n  position: relative;\r\n  z-index: 999;\r\n  background-color: #fff;\r\n  height: 100vh;\r\n}\r\n\r\n.detail-nav {\r\n  position: relative;\r\n  z-index: 999;\r\n  background-color: #fff;\r\n}\r\n\r\n.content {\r\n  background-color: #fff;\r\n  height: calc(100% - 44px);\r\n}\r\n</style>"],"sourceRoot":"src\\views\\detail"}]}